<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bài Thực Hành Chương 2</title>
    <link rel="stylesheet" href="bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <script src="bootstrap.bundle.min.js"></script>
    <nav class="navbar navbar-expand-lg" id="Tieu_de_chinh">
        <div class="container-fluid justify-content-center">
            <p class="text-white text-center" id="text_chinh">Hệ Thống Quản Lý Sinh Viên</p>
        </div>
    </nav>
    <div class="container mt-4">
        <div class="layout-container">
            <div id="form_them">
                <div class="container_Tieu_de_form_them">
                    <h3 class="text-white p-2 rounded text-center">Form Thêm Sinh Viên</h3>
                </div>
                <div class="card p-4" id="box_them_sinhvien">
                    <form>
                        <div class="mb-3">
                            <label for="maSV" class="form-label">Mã sinh viên:</label>
                            <input type="text" class="form-control" id="maSV" name="maSV" required>
                        </div>
                        <div class="mb-3">
                            <label for="hoTen" class="form-label">Họ và tên:</label>
                            <input type="text" class="form-control" id="hoTen" name="hoTen" required>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">Email:</label>
                            <input type="email" class="form-control" id="email" name="email" required>
                        </div>
                        <div class="mb-3">
                            <label for="ngaySinh" class="form-label">Ngày sinh:</label>
                            <input type="date" class="form-control" id="ngaySinh" name="ngaySinh">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Giới tính:</label>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="gioiTinh" id="nam" value="Nam">
                                <label class="form-check-label" for="nam">Nam</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="gioiTinh" id="nu" value="Nữ">
                                <label class="form-check-label" for="nu">Nữ</label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="ghiChu" class="form-label">Ghi chú:</label>
                            <textarea class="form-control" id="ghiChu" name="ghiChu" rows="4"></textarea>
                        </div>
                        <button type="submit" class="btn btn-block w-100" id="btn_Themsv">Thêm sinh viên</button>
                        <p id="thongBao"></p>
                    </form>
                </div>
            </div>
            <div class="col">
                <div class="container_Tieu_de_dssv">
                    <h3 id="Tieu_de_dssv">Danh Sách Sinh Viên</h3>
                </div>
                <div class="table-responsive">
                    <table id="box_ds_sinhvien">
                        <thead>
                            <tr>
                                <th>STT</th>
                                <th>Mã SV</th>
                                <th>Họ tên</th>
                                <th>Email</th>
                                <th>Giới tính</th>
                                <th>Ngày sinh</th>
                                <th>Ghi chú</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>SV001</td>
                                <td>Nguyễn Thiên Hương</td>
                                <td>nth@example.com</td>
                                <td>Nữ</td>
                                <td>2001-01-01</td>
                                <td></td> 
                                <td>
                                    <button class="btn btn-outline-primary btn-sm me-1" onclick="suaDong(this)">Sửa</button>
                                    <button class="btn btn-outline-danger btn-sm" onclick="xoaDong(this)">Xoá</button>
                                </td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>SV002</td>
                                <td>Nguyễn Sinh Cung</td>
                                <td>nsc@example.com</td>
                                <td>Nam</td>
                                <td>2002-02-02</td>
                                <td></td> 
                                <td>
                                    <button class="btn btn-outline-primary btn-sm me-1" onclick="suaDong(this)">Sửa</button>
                                    <button class="btn btn-outline-danger btn-sm" onclick="xoaDong(this)">Xoá</button>
                                </td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>SV003</td>
                                <td>Phan Đức Tuấn</td>
                                <td>pdt@example.com</td>
                                <td>Nam</td>
                                <td>2000-03-03</td>
                                <td></td> 
                                <td>
                                    <button class="btn btn-outline-primary btn-sm me-1" onclick="suaDong(this)">Sửa</button>
                                    <button class="btn btn-outline-danger btn-sm" onclick="xoaDong(this)">Xoá</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script>
        let selectedRow = null;

        document.getElementById("btn_Themsv").addEventListener("click", function(event) {
            event.preventDefault();
            alert("Đã nhấn nút Thêm");

            
            let maSV = document.getElementById("maSV").value.trim();
            let hoTen = document.getElementById("hoTen").value.trim();
            let email = document.getElementById("email").value.trim();
            let ngaySinh = document.getElementById("ngaySinh").value || "Chưa nhập";
            let gioiTinh = document.querySelector('input[name="gioiTinh"]:checked') ? document.querySelector('input[name="gioiTinh"]:checked').value : "Chưa chọn";
            let ghiChu = document.getElementById("ghiChu").value || "Không có ghi chú";

            if (maSV === "") {
                alert("Mã sinh viên không được để trống!");
                return;
            }
            if (hoTen === "") {
                alert("Họ và tên không được để trống!");
                return;
            }
            let regexEmail = /^\S+@\S+\.\S+$/;
            if (!regexEmail.test(email)) {
                alert("Email không hợp lệ!");
                return;
            }

            // Tiết 2: Thêm dòng mới hoặc cập nhật
            let table = document.getElementById("box_ds_sinhvien").getElementsByTagName("tbody")[0];
            if (selectedRow) {
                // Tiết 6: Cập nhật dòng, bao gồm Ghi chú
                selectedRow.cells[1].innerText = maSV;
                selectedRow.cells[2].innerText = hoTen;
                selectedRow.cells[3].innerText = email;
                selectedRow.cells[4].innerText = gioiTinh;
                selectedRow.cells[5].innerText = ngaySinh;
                selectedRow.cells[6].innerText = ghiChu; // Cập nhật Ghi chú
                selectedRow = null;
                thongBao("Cập nhật thành công!");
            } else {
                let newRow = table.insertRow();
                newRow.classList.add("table_dssv");
                let stt = table.rows.length;

                newRow.insertCell(0).innerText = stt;
                newRow.insertCell(1).innerText = maSV;
                newRow.insertCell(2).innerText = hoTen;
                newRow.insertCell(3).innerText = email;
                newRow.insertCell(4).innerText = gioiTinh;
                newRow.insertCell(5).innerText = ngaySinh;
                newRow.insertCell(6).innerText = ghiChu; // Thêm Ghi chú
                newRow.insertCell(7).innerHTML = `
                    <button class="btn btn-outline-primary btn-sm me-1" onclick="suaDong(this)">Sửa</button>
                    <button class="btn btn-outline-danger btn-sm" onclick="xoaDong(this)">Xoá</button>
                `;
                thongBao("Thêm sinh viên thành công!");
            }

            // Reset form
            document.querySelector("form").reset();
        });

        // Tiết 4: Xóa dòng
        function xoaDong(btn) {
            if (confirm("Bạn có chắc chắn muốn xoá?")) {
                btn.parentElement.parentElement.remove();
                let tbody = document.getElementById("box_ds_sinhvien").getElementsByTagName("tbody")[0];
                for (let i = 0; i < tbody.rows.length; i++) {
                    tbody.rows[i].cells[0].innerText = i + 1;
                }
                thongBao("Xoá thành công!");
            }
        }

        // Tiết 6: Sửa dòng, bao gồm Ghi chú
        function suaDong(btn) {
            selectedRow = btn.parentElement.parentElement;
            document.getElementById("maSV").value = selectedRow.cells[1].innerText;
            document.getElementById("hoTen").value = selectedRow.cells[2].innerText;
            document.getElementById("email").value = selectedRow.cells[3].innerText;
            document.getElementById("ngaySinh").value = selectedRow.cells[5].innerText;
            let gioiTinhValue = selectedRow.cells[4].innerText;
            if (gioiTinhValue === "Nam") {
                document.getElementById("nam").checked = true;
            } else if (gioiTinhValue === "Nữ") {
                document.getElementById("nu").checked = true;
            }
            document.getElementById("ghiChu").value = selectedRow.cells[6].innerText; // Điền Ghi chú
        }

        // Hàm hiển thị thông báo
        function thongBao(message) {
            let thongBao = document.getElementById("thongBao");
            thongBao.style.display = "block";
            thongBao.innerText = message;
            setTimeout(() => {
                thongBao.style.display = "none";
            }, 3000);
        }
    </script>
</body>
</html>